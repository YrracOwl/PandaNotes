/*!
 * Super Context Menu
 * Created by EZ17-1, pwnedgod @ github
 */
"use strict";window.superCm=function(c){var d={minWidth:null,maxHeight:null,autoClose:!1,searchBar:!1,searchBarPlaceholder:"Search...",zIndex:50},s=$("<div>").addClass("context-menu").append($("<div>").addClass("context-menu-options")),p=$("<div>"),a=$("<div>").addClass("context-menu-search").append($("<input>").prop({type:"text",placeholder:d.searchBarPlaceholder})),m=$("<i>").addClass("option-icon"),h=$("<span>").addClass("option-text"),f=$("<hr>").addClass("option-separator"),x=[],v=null;function l(e,n){e=x[e];return e.search.result&&!n?e.search.result:e.opts}function g(e){return x[e].element.find(".context-menu-options")}function w(e){return g(e).children()}function b(e,n){return g(e).children().eq(n)}function I(n,t){if(null==v||v.cmIndex!=n||v.optIndex!=t){if(null!=v){let e=b(v.cmIndex,v.optIndex);e.hasClass("active")&&e.removeClass("active")}if(-1!=n&&-1!=t){let e=b(n,t);e.hasClass("active")||e.addClass("active"),v={cmIndex:n,optIndex:t}}else v=null}}function C(n,t){var o=x[n].activeSubmenu;if(o!=t){if(-1!=o){let e=b(n,o);e.hasClass("active-submenu")&&e.removeClass("active-submenu")}if(-1!=t){let e=b(n,t);e.hasClass("active-submenu")||e.addClass("active-submenu")}x[n].activeSubmenu=t}}function y(n){void 0===n&&(n=0),null!=v&&n<=v.cmIndex&&I(-1,-1);for(let e=x.length-1;e>=n;e--)x.pop().element.remove()}function u(c){var r=x[c],n=l(c,!1);(n=0==n.length?[{label:"&lt; Empty &gt;",disabled:!0}]:n).forEach(function(n,t){var e=b(c,t),o=void 0!==n.separator,i=void 0!==n.icon&&n.icon,s=void 0!==n.label&&n.label,a=void 0!==n.disabled&&n.disabled,l=void 0!==n.action&&n.action,u=void 0!==n.submenu&&n.submenu;if(e.length?(e.empty(),e.off(),e.removeClass()):(e=p.clone()).appendTo(g(c)),o)return e.hasClass("context-menu-separator")||e.addClass("context-menu-separator"),void e.append(f.clone());i&&e.append(m.clone().addClass(n.icon)),s&&e.append(h.clone().html(n.label)),a?e.hasClass("context-menu-disabled")||e.addClass("context-menu-disabled"):(l&&e.click(function(){d.autoClose?y():(y(c+1),C(c,-1)),n.action(n,c,t)}),u?(e.on("submenu",function(){var e;r.activeSubmenu!=t&&(e=c+1,C(c,t),y(e),M(n.submenu,e,{x:r.position.x+r.element.outerWidth(),y:r.position.y+this.offsetTop-this.parentElement.scrollTop-parseInt(g(c).css("padding-top"))}))}),e.mouseenter(function(){I(c,t),$(this).trigger("submenu")}),e.hasClass("context-menu-submenu")||e.addClass("context-menu-submenu")):(e.mouseenter(function(){I(c,t),C(c,-1),y(c+1)}),e.hasClass("context-menu-option")||e.addClass("context-menu-option")),e.mouseleave(function(){v.cmIndex==c&&v.optIndex==t&&I(-1,-1)}))});var t=w(c);for(let e=t.length-1;e>=n.length;e--)t.eq(e).remove()}function r(e,n,t){void 0===n&&(n=!0),void 0===t&&(t=!0);var o,i,s=x[e];0<e&&(i=b(o=e-1,(u=x[o]).activeSubmenu),s.position={x:u.position.x+u.element.outerWidth(),y:u.position.y+i[0].offsetTop-i[0].parentElement.scrollTop-parseInt(g(o).css("padding-top"))}),n&&(n=s.element.outerWidth(),s.position.x-$(window).scrollLeft()+n>=$(window).innerWidth()&&(s.position.x-=n,0<e&&(s.position.x-=u.element.outerWidth()),s.position.x<$(window).scrollLeft()&&(s.position.x=$(window).scrollLeft())),s.element.css("left",s.position.x));var a,l,u=s.element.outerHeight();t&&(s.position.y-$(window).scrollTop()+u>=$(window).innerHeight()&&(s.position.y-=u,0<e&&(t=parseInt(g(e).css("padding-bottom")),l=w(e).last(),a=parseInt(g(e).css("padding-top")),s.position.y+=t+a+l.outerHeight()),s.position.y<$(window).scrollTop()&&(s.position.y=$(window).scrollTop())),s.element.css("top",s.position.y)),null===d.maxHeight?(a=s.position.y-$(window).scrollTop(),c?(l=$(window).innerHeight()-a)<u&&s.element.css("height",l):s.element.css("max-height","calc(100vh - "+a+"px)")):c?u>d.maxHeight&&s.element.css("height",d.maxHeight):s.element.css("max-height",d.maxHeight),null!==d.minWidth&&s.element.css("min-width",d.minWidth),s.element.css("z-index",d.zIndex+e)}function T(e){var n=x[e];if(null!==n.search.input){var t=n.search.input.val().trim();if(""==t)return n.search.result=null,void u(e);I(-1,-1);e=[];!function o(i,e,s){e.forEach(function(e){var n,t=!1;void 0===e.label||!e.label||(n=e.label.toLowerCase())&&-1!=n.indexOf(s)&&(i.push(e),t=!0),!t&&void 0!==e.submenu&&e.submenu.length&&o(i,e.submenu,s)})}(e,n.opts,t.toLowerCase()),n.search.result=e}}function M(e,n,t){var o,i=s.clone();d.searchBar&&0==n&&(o=a.clone()).prependTo(i);e={element:i,position:t,opts:e,activeSubmenu:-1,search:{input:o?o.find("input"):null,result:null}};x.push(e),g(n).scroll(function(){C(n,-1),y(n+1)}),I(-1,-1),v={cmIndex:n,optIndex:-1},i.appendTo(document.body),u(n),r(n),o&&e.search.input.on("input",function(){y(n+1),T(n),u(n),r(n,!0,!1)}).focus()}function o(e,n,t){var o=w(e);n>=o.length?n=0:n<0&&(n=o.length-1);for(var i,s=n;i=s,void 0!==(i=l(e,!1)[i]).separator||void 0!==i.disabled&&i.disabled;){if((s+=t?-1:1)==n)return-1;s>=o.length?s=0:s<0&&(s=o.length-1)}return s}return $(document).on("mousedown.scm contextmenu.scm",".context-menu, .opt-text, .opt-icon, .opt-separator",function(e){e.stopPropagation()}),$(document).on("keydown.scm",function(e){var n,t;"Escape"!=e.key&&27!=e.which||y(),0<x.length&&("ArrowUp"==e.key||38==e.which?(e.preventDefault(),function(){if(null==v||-1==v.optIndex){var e=x.length-1,n=l(e);return n.length<=0||I(e,n.length-1)}-1!=(n=o(v.cmIndex,v.optIndex-1,!0))&&I(v.cmIndex,n)}()):"ArrowDown"==e.key||40==e.which?(e.preventDefault(),function(){if(null==v||-1==v.optIndex){var e=x.length-1;return l(e).length<=0||I(e,0)}-1!=(e=o(v.cmIndex,v.optIndex+1,!1))&&I(v.cmIndex,e)}()):"Enter"==e.key||13==e.which?(e.preventDefault(),b(v.cmIndex,v.optIndex).click()):"ArrowLeft"==e.key||37==e.which?null!=v&&0<v.cmIndex&&(e.preventDefault(),n=v.cmIndex-1,t=x[n].activeSubmenu,y(v.cmIndex),C(n,-1),I(n,t)):"ArrowRight"!=e.key&&39!=e.which||null==v||-1==v.optIndex||(t=b(v.cmIndex,v.optIndex)).hasClass("context-menu-submenu")&&(e.preventDefault(),t.trigger("submenu")))}),$(document).on("mousedown.scm",function(){y()}),$(window).on("scroll.scm resize.scm",function(){y()}),{settings:d,createMenu:function(e,n){y(),M(e,0,{x:n.pageX,y:n.pageY})},destroyMenu:function(){y()},updateMenu:function(t,o){x.forEach(function(e,n){T(n),u(n),r(n,t,o)})},updateMenuIndex:function(e,n,t){T(e),u(e),r(e,n,t)},getMenuOptions:function(e){return x[e].opts},addMenuOption:function(e,n,t){void 0!==t?x[e].opts.splice(t,0,n):x[e].opts.push(n)},addMenuOptions:function(e,n,t){void 0!==t?Array.prototype.splice.apply(x[e].opts,[t,0].concat(n)):x[e].opts=x[e].opts.concat(n)},deleteMenuOption:function(e,n){x[e].opts.splice(n,1)},setMenuOption:function(e,n,t){x[e].opts[n]=t},setMenuOptions:function(e,n){x[e].opts=n},isOpen:function(){return 0!==$(".context-menu").length}}}("Microsoft Internet Explorer"==navigator.appName||/Trident/.test(navigator.userAgent)||/rv:11/.test(navigator.userAgent));